<%#= @clients.to_json({

    # @clients variable contains any clients matching the search criteria.
    # To reduce bloat we specify explicitly which fields to include in the json:

    :only => [
      :id,
      :name,      # AKA surname
      :forename,
      :email1,
      :email2
      #:address1,
      #:address2,
      #:address3,
      #:address4,
      #:address5,
      #:postcode
    ],

    # Any non-datamapper properties need to be handled differently:
    :methods => [
      :fullname,
      :shortname,
      :trips_lite   # This is a custom 'lite' alternative to the full trips collection.
    ]
  })
%>
